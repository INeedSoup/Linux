When you run a program in Linux, the system assigns several user IDs to the process. These IDs determine what the process is allowed to do, which files it can access, and how it behaves when special permission bits like SUID are involved.

Understanding these IDs helps explain why SUID programs can gain temporary elevated access without giving full administrative control to the user running them.

---

## **1. The Three UIDs Attached to Every Process**

Linux associates three different user IDs with every running process:

### **1. Real User ID (RUID)**

- The user who launched the process.    
- Used for accounting, auditing, and tracking who started the program.    
- Does **not** determine file access by itself.    

Example:  
If Bob runs `touch file.txt`, the RUID is Bob’s UID.

### **2. Effective User ID (EUID)**

- The ID that determines the process’s _current permissions_.    
- Controls what files the process can read, write, or modify.    
- Usually the same as RUID, **unless** SUID changes it.    

Example:  
Running `passwd` gives you an EUID of **0** (root), even if your RUID is something like 500.

### **3. Saved User ID (SUID / Saved UID)**

- Stores a previous EUID so a process can switch back to it later.    
- Used mainly by SUID programs to temporarily drop or regain privileges.    
- Helps limit how long elevated permissions are used.    

This prevents programs from running as root the entire time when only part of the operation requires it.

---

## **2. How These UIDs Work Together (The `passwd` Example)**

The `passwd` program must write to `/etc/shadow`, which only root can modify.  
The file is owned by root:

```
-rw-r----- 1 root shadow ...
```

But the `passwd` binary has the SUID bit:

```
-rwsr-xr-x 1 root root ...
```

Here’s what happens step-by-step:

### **Step 1: You run `passwd`**

- Real UID (RUID): **your UID** (for example, 500)    
- Effective UID (EUID): **0** because of SUID    
- Saved UID: stores root’s UID (0)    

### **Step 2: The program checks whose password is being changed**

You might try to change Sally’s password (UID 600), but:

- The program checks your **real UID**    
- It sees you are not Sally    
- It sees you are not root    
- So you cannot modify her password    

SUID does not let you impersonate other regular users—only the owner of the program file.

### **Step 3: The program can temporarily drop and regain privileges**

Using the saved UID, the program can:

- Drop root privileges when not needed    
- Switch back to root only when performing secure operations    

This minimizes the amount of time that elevated access is used.

---

## **3. Why This Matters for Security**

- **EUID** determines what a process _can_ do.    
- **RUID** determines _who_ is running the process.    
- **SUID programs** only escalate permissions for the program’s owner, not to other users.    
- **Saved UID** helps programs avoid staying privileged longer than necessary.    

Most processes run with RUID = EUID because they don't require special permissions.